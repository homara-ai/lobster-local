{
  "test_report": {
    "overall_summary": {
      "total_services_tested": 5,
      "total_tests_run": 244,
      "total_tests_passed": 121,
      "total_tests_failed": 122,
      "total_errors": 1,
      "overall_status": "CRITICAL_FAILURES",
      "test_success_rate": "49.6%",
      "critical_issues_found": 4,
      "import_status": "ALL_IMPORTS_SUCCESSFUL"
    },
    "services": {
      "proteomics_preprocessing_service": {
        "service_name": "ProteomicsPreprocessingService",
        "file_path": "/Users/tyo/GITHUB/lobster/lobster/tools/proteomics_preprocessing_service.py",
        "test_file_path": "/Users/tyo/GITHUB/lobster/tests/unit/tools/test_proteomics_preprocessing_service.py",
        "status": "PARTIAL",
        "description": "MS/affinity filtering, normalization (TMM, quantile, VSN)",
        "test_results": {
          "total_tests": 52,
          "passed": 41,
          "failed": 11,
          "errors": 0,
          "success_rate": "78.8%"
        },
        "import_status": "SUCCESS",
        "key_functionality": [
          "Missing value imputation (KNN, min_prob, MNAR, mixed)",
          "Intensity normalization (median, quantile, VSN, total_sum)",
          "Batch correction (ComBat, median centering, reference-based)",
          "Log transformation with pseudocounts"
        ],
        "issues_found": [
          "Multiple imputation method tests failing",
          "Missing statistics keys in test assertions",
          "Raw data preservation tests failing",
          "Large dataset imputation test issues"
        ],
        "error_patterns": [
          "KeyError: 'samples_processed' in large dataset tests",
          "Missing value detection logic inconsistencies",
          "Statistics return format mismatches"
        ],
        "recommendations": [
          "Fix missing statistics keys in imputation methods",
          "Review test data setup for missing value detection",
          "Standardize statistics dictionary structure",
          "Add proper error handling for edge cases"
        ]
      },
      "proteomics_quality_service": {
        "service_name": "ProteomicsQualityService",
        "file_path": "/Users/tyo/GITHUB/lobster/lobster/tools/proteomics_quality_service.py",
        "test_file_path": "/Users/tyo/GITHUB/lobster/tests/unit/tools/test_proteomics_quality_service.py",
        "status": "FAIL",
        "description": "Missing value patterns, CV analysis, batch detection",
        "test_results": {
          "total_tests": 45,
          "passed": 13,
          "failed": 32,
          "errors": 0,
          "success_rate": "28.9%"
        },
        "import_status": "SUCCESS",
        "key_functionality": [
          "Missing value pattern assessment (MCAR vs MNAR)",
          "Coefficient of variation analysis",
          "Contaminant detection",
          "Dynamic range evaluation",
          "PCA outlier detection",
          "Technical replicate assessment"
        ],
        "issues_found": [
          "Widespread test failures across all major functions",
          "Missing value pattern identification failing",
          "CV analysis not working properly",
          "PCA outlier detection issues",
          "Technical replicate assessment broken"
        ],
        "error_patterns": [
          "AssertionError: Function calls not matching expected parameters",
          "Missing method calls to underlying analysis functions",
          "Statistics calculation inconsistencies"
        ],
        "recommendations": [
          "Complete rewrite/review of service implementation",
          "Fix method signature mismatches",
          "Implement missing core functionality",
          "Add comprehensive error handling",
          "Review test data setup and expectations"
        ]
      },
      "proteomics_analysis_service": {
        "service_name": "ProteomicsAnalysisService",
        "file_path": "/Users/tyo/GITHUB/lobster/lobster/tools/proteomics_analysis_service.py",
        "test_file_path": "/Users/tyo/GITHUB/lobster/tests/unit/tools/test_proteomics_analysis_service.py",
        "status": "PASS",
        "description": "Statistical testing, PCA, clustering",
        "test_results": {
          "total_tests": 50,
          "passed": 46,
          "failed": 3,
          "errors": 1,
          "success_rate": "92.0%"
        },
        "import_status": "SUCCESS",
        "key_functionality": [
          "Statistical testing (t-test, Mann-Whitney, ANOVA, Kruskal-Wallis)",
          "Dimensionality reduction (PCA, t-SNE, UMAP-like)",
          "Clustering analysis (K-means, hierarchical, Gaussian mixture)",
          "Pathway enrichment analysis"
        ],
        "issues_found": [
          "t-SNE dimensionality issues with PCA preprocessing",
          "Small perplexity parameter handling in t-SNE",
          "Pathway enrichment database connection error"
        ],
        "error_patterns": [
          "ValueError: n_components=50 must be between 0 and min(n_samples, n_features)=48",
          "PCA component validation not handling edge cases properly"
        ],
        "recommendations": [
          "Add dynamic PCA component calculation based on data dimensions",
          "Improve t-SNE parameter validation",
          "Fix pathway enrichment database connectivity",
          "Add better edge case handling for small datasets"
        ]
      },
      "proteomics_differential_service": {
        "service_name": "ProteomicsDifferentialService",
        "file_path": "/Users/tyo/GITHUB/lobster/lobster/tools/proteomics_differential_service.py",
        "test_file_path": "/Users/tyo/GITHUB/lobster/tests/unit/tools/test_proteomics_differential_service.py",
        "status": "FAIL",
        "description": "Linear models with empirical Bayes, FDR control",
        "test_results": {
          "total_tests": 44,
          "passed": 19,
          "failed": 25,
          "errors": 0,
          "success_rate": "43.2%"
        },
        "import_status": "SUCCESS",
        "key_functionality": [
          "Differential expression analysis",
          "Time course analysis (linear/polynomial trends)",
          "Correlation analysis (Pearson/Spearman)",
          "Statistical testing with FDR correction"
        ],
        "issues_found": [
          "Differential expression analysis core functionality failing",
          "Time course analysis completely broken",
          "Correlation analysis not working",
          "Statistical calculations producing errors"
        ],
        "error_patterns": [
          "AttributeError: 'Series' object has no attribute 'reshape'",
          "RuntimeWarning: divide by zero encountered in scalar divide",
          "Method signature mismatches between implementation and tests"
        ],
        "recommendations": [
          "Fix pandas Series vs numpy array handling",
          "Add proper error handling for division by zero",
          "Review and fix time course analysis implementation",
          "Standardize correlation analysis methods",
          "Add comprehensive input validation"
        ]
      },
      "proteomics_visualization_service": {
        "service_name": "ProteomicsVisualizationService",
        "file_path": "/Users/tyo/GITHUB/lobster/lobster/tools/proteomics_visualization_service.py",
        "test_file_path": "/Users/tyo/GITHUB/lobster/tests/unit/tools/test_proteomics_visualization_service.py",
        "status": "CRITICAL_FAIL",
        "description": "Volcano plots, correlation networks, QC dashboards",
        "test_results": {
          "total_tests": 53,
          "passed": 2,
          "failed": 51,
          "errors": 0,
          "success_rate": "3.8%"
        },
        "import_status": "SUCCESS",
        "key_functionality": [
          "Missing value heatmaps",
          "Intensity distribution plots",
          "CV analysis plots",
          "Volcano plots",
          "Protein correlation networks",
          "Pathway enrichment plots",
          "QC dashboards"
        ],
        "issues_found": [
          "Nearly complete failure of all visualization methods",
          "All plot generation methods failing",
          "Plot saving functionality broken",
          "Dashboard creation completely non-functional"
        ],
        "error_patterns": [
          "Consistent failures across all visualization methods",
          "Method calls not reaching expected implementation",
          "Plot object creation and manipulation failures"
        ],
        "recommendations": [
          "URGENT: Complete service rewrite required",
          "Implement missing core visualization methods",
          "Fix plot generation and saving infrastructure",
          "Add comprehensive Plotly integration",
          "Implement proper error handling for edge cases",
          "Review service architecture and method signatures"
        ]
      }
    },
    "critical_findings": {
      "most_critical_service": "proteomics_visualization_service",
      "services_requiring_immediate_attention": [
        "proteomics_visualization_service",
        "proteomics_quality_service",
        "proteomics_differential_service"
      ],
      "services_in_good_condition": [
        "proteomics_analysis_service"
      ],
      "services_needing_minor_fixes": [
        "proteomics_preprocessing_service"
      ]
    },
    "common_issues": [
      "Method signature mismatches between implementation and tests",
      "Missing statistics keys in return dictionaries",
      "Inconsistent error handling across services",
      "Edge case handling for small datasets",
      "Division by zero and numerical stability issues"
    ],
    "recommendations": {
      "immediate_actions": [
        "Prioritize proteomics_visualization_service complete rewrite",
        "Fix proteomics_quality_service core functionality",
        "Address proteomics_differential_service pandas/numpy issues"
      ],
      "medium_term_fixes": [
        "Standardize statistics dictionary structures across all services",
        "Implement comprehensive input validation",
        "Add better error handling and logging",
        "Review and update test expectations"
      ],
      "long_term_improvements": [
        "Create service interface standardization",
        "Implement comprehensive integration tests",
        "Add performance benchmarking",
        "Create service documentation and examples"
      ]
    },
    "test_environment": {
      "python_version": "3.13.6",
      "pytest_version": "8.4.1",
      "test_framework": "pytest with uv",
      "platform": "macOS-15.6.1-arm64",
      "test_date": "2025-09-25"
    }
  }
}